{"name":"minoTour","tagline":"Real time data analysis tools for the Oxford Nanopore minION sequencing platform.","body":"### Welcome to minoTour.\r\nminoTour is a suite of web based tools that enable real time analysis of read files generated by the Oxford Nanopore minION sequencing device. This page provides additional information on the tools themselves. Full installation instructions for setting up your own minoTour server are contained in the PDF file in the repository itself.\r\n\r\nBy far the easiest way to use minoTour is with our Nottingham, UK, based server at <http://minotour.nottingham.ac.uk/>\r\nIf you wish to use our server you will need to register at <http://minotour.nottingham.ac.uk/register_new.php> and then email your user name to me (matt.loose(at)nottingham.ac.uk) to request that we activate your account for data submission). \r\n\r\nA video describing some of the features on minoTour is available here:\r\n<https://www.youtube.com/embed/fZRMMSsw7O4>\r\n\r\n### Installation and Configuration Instructions for your own minoTour server.\r\nWe provide an example for configuring an Ubuntu 14.04 server for minoTour. You should obviously modify these instructions as you need for your favour of UNIX. Instructions for configuring minoTour on the same computer as the minION device will be provided at a later date.\r\n\r\nStep 1 - LAMP Installation and memcached\r\n\r\nIf you do not already have LAMP installed then follow the instructions below. You will also need memcached running on your server. This is currently optional but will become required for planned future features in minoTour.\r\n\r\n`:-$ sudo apt-get update`\r\n\r\n`:-$ sudo apt-get install lamp-server^`\r\n\r\n`:-$ sudo apt-get install memcached php5-memcache`\r\n\r\nNote - you really should set a password for the mySQL root user when prompted to at this point…you will use this later on. Also make sure your local firewalls are configured to allow access for http, https, ssh (for admin) and mySQL and the necessary ports are open on your server.\r\n\r\nStep 2 - Perl Background Processes\r\n\r\nYou need to install the perl memcached module\r\n\r\n`sudo apt-get install libcache-memcached-perl`\r\n\r\nYou should also install the following perl module (#idiot check - you may need to install make if it isn't already on your system… `sudo apt-get install make` )\r\n\r\n`Parallel-Loops`\r\n\r\nStep 3 - Configure mySQL for minoTour.\r\n\r\nIf you are using ubuntu, you have to use the following steps to enable mySQL to communicate with the outside world:\r\nrun the command \r\n\r\n`vim /etc/mysql/my.cnf`\r\n\r\nComment out the bind-address line using the # symbol:\r\n\r\n`#bind-address = 127.0.0.1`\r\n\r\nrestart your mysql server once.\r\n\r\n`sudo /etc/init.d/mysql restart`\r\n\r\n### Configuring the minoTour package.\r\n\r\nThe database works as follows. Each new run is added to its own unique database. This allows for relatively simple management of run data and shifting of databases to different locations in the future. To manage these databases, a master database is created (‘Gru’ - it controls the minIONs…). Gru allocates databases to users, controls access to the website and is absolutely essential to the operation of minoTour.\r\n\r\nIn order for this system to work, you create mySQL users that have permission to create and delete databases. This creates risks for your mySQL system and it is unlikely that any centrally managed facility will allow you to do this - you therefore need access to your own mySQL installation. To negate these risks, we create users that can only create and destroy databases which belong to them, defined by their own user names - this means that users cannot delete other databases in your mySQL installation - PHEW! To simplify the creation of these accounts, we have generated a number of scripts to automate this process (found in the folder 'mT_server/db_control/'). These scripts assume that you have access to the mySQL server and can connect to mySQL as root. You should ensure that the scripts have the necessary permissions to run on your server.\r\n\r\nFirstly you need to create the basic database Gru and establish an account on mySQL that can be used by the website to show all the data (the ‘webuser'). You need to use the initialiseDB script and have the Gru.sql file (found in the 'mT_server/db_control/setup' folder).\r\n\r\nThis account has full access to all the databases created by the upload scripts. The website archive features require that the webuser account can drop tables and can access all users data. The datasets that can be seen by individual users is managed by the Gru database itself.\r\n\r\nAssuming that you have root access to your mySQL install go to the command line and execute the initialiseDB script. You need to pass the script three variables. The username you wish to use for your webuser, the password and the ip address of the web server which will be connecting to the database. If your web server and mySQL database are on the same machine, use ‘localhost’ for this last option. The script will request your mySQL root password twice whilst it is running.\r\n\r\n`>./initialiseDB <webusername> <webpassword> <ip>`\r\n\r\nIf this process has been successful you should now be able to log in to mySQL with the following command:\r\n\r\n`>mysql -u <webusername> -p`\r\n\r\nand provide the <webpassword> on request. Typing \r\n\r\n`mysql> show databases;`\r\n\r\nshould list the presence of the Gru database.\r\n\r\nThe username and password created here will be used later to connect the minoTour website to your mySQL database.\r\n\r\nNext you need to create accounts for users to actually upload data to the database. How you manage this process is up to you. We allow users to log in to the website and create an account for accessing the website choosing there own username. We then use this username to enable connection to the mySQL database. However these account names do not have to be the same.\r\n\r\nIMPORTANT: Do not use _ in the user name. This will break functionality elsewhere in the package.\r\n\r\nTo create an account use the ‘createuser’ script (located in 'mT_server/db_control/admin'). This requires 3 arguments. The <username>, <userpassword> and the <ip> address from which they are connecting to your mySQL server. This is an important security feature as it limits the possibility of malicious connection to your database. To add additional IP addresses in the future we provide the script addusersource (see below). The simplest option is to use the wildcard symbol %. This will allow the user to connect from any computer anywhere. It will also resolve an issue where the machine connecting to the database does not have a fixed IP address. To create a user account execute the ‘createuser’ script. The username you use here must be associated with an account on the web site. e.g If Joe Bloggs creates a user account on the website called JB123, his account for uploading data in mySQL should also be called JB123.\r\n\r\n`>./createuser <username> <userpassword> <ip>`\r\n\r\nYou will need to communicate the <userpassword> to the user directly. There is no way that they can find this information out otherwise. The option to change the user password on the website will not alter the mySQL password set here.\r\nTo add additional connection points for this user run the addusersource script providing the username and the additional IP address.\r\n\r\n`>./addusersource <username> <new_ip>`\r\n\r\nIf you need to delete a user then run the dropuser script. This requires only the username to prevent any access to the database for that user. This does not remove any data OR prevent the user from seeing the data in the minoTour website.\r\n\r\n`>./dropuser <username>`\r\n\r\nHaving done this, we shall now configure the website.\r\n\r\n\tImportant: we will return to mySQL to configure our admin account shortly.\r\n\r\n### minoTour WebSite installation.\r\n\r\nConfiguring the website is straightforward. Copy the entire 'minoTour' folder located in the mT_web folder (which contains the web application) into the appropriate root folder for your webserver. In OSX this folder is usually called:\r\n\r\n`/Library/WebServer/Documents`\r\n\r\nIn unix systems it may be\r\n\r\n`/var/www/html/`\r\n\r\nThe name of the folder dictates the url for your website. You can change this if you wish.\r\n\r\nUpgrade Notes: You may wish to install your new version of minoTour in place of the previous version. We would suggest first setting the site up in an alternative location and checking the configuration before writing over your previous installation. The new version of minoTour includes a 'previous versions' tab which will allow you to go back and use older versions of minoTour. Most importantly you need to keep note of the DB-HOST and DB_PASS values from the db.php file in the config folder and ensure these values are used in the new minoTour install.\r\n\r\nYou may need to use 'sudo' privileges to copy this folder into the appropriate location.\r\n\r\nNow - assuming you are on the same machine as your webServer and have not changed the folder name, open a browser window and navigate to:\r\n\r\n`http://localhost/minoTour`\r\n\r\nAnd you should see a nice welcoming page… - if you don’t - check that you have php and apache correctly configured on your machine. Google is your friend…\r\n\r\nIf you do not see the video, then your webServer is unable to connect to the outside world. This isn’t critical but will limit some functionality in our system. In particular it will prevent you submitting bug reports and feature requests via the website to us.\r\n\r\nBefore going any further, you need to configure the website to talk to your database.\r\n\r\nTo do this, navigate to the folder ‘config’ which is located within the minoTour folder. In this folder is a file called ‘db_example.php’.\r\nOpen this file with a text editor and you will see lines including:\r\n\r\ndefine(\"DB_HOST\", \"127.0.0.1\"); \r\ndefine(\"DB_NAME\", \"Gru\"); \r\ndefine(\"DB_USER\", \"\"); \t\r\ndefine(\"DB_PASS\", \"\"); \t\t\r\ndefine(\"DB_PORT\", 3306);\r\n\r\nIf your database is on the same machine as your webserver, leave DB_HOST set to “127.0.01”. If this doesn’t work, switch it to “localhost”. If your mySQL database is on a remote machine, then enter the IP address of that machine here. Then set DB_USER and DB_PASS to the user name and password that you used when setting up the database above. If you have mySQL configured on a non standard port you can set that here. When you save this file, save it as db.php in the config folder. \r\n\r\n\tImportant: Each time a new release of minoTour is made available you should check the db_example.php file to see if new global parameters have been established.\r\n\r\nNow return to your web browser - we will make an account for you to access the site - to do so go to register_new.php . \r\n\t\r\nImportant: For minoTour versions 0.43 and beyond we have removed the publicly accessible registration page. This prevents malicious account creation. To find the page to register a new user go to minoTour/register_new.php rather than index.php .\r\n\r\nThis first account is important as we are going to make it the system administrator. Use your choice of username and password. Providing a valid email address is important as it allows us to contact you in the event of bugs or other problems. Complete the form and register away.\r\n\r\nIf all has worked well you will be rewarded with a success message… Return to the login page and use your shiny new account to log in.\r\n\r\nIf your machine is on a network where it can see the outside world, you will have the news items listed. If you do, then the bug reporting and feature requests will work. If you do not, then these buttons won’t function for you.\r\n\r\nThe last thing we need to do is set this account as an administrator. To do that, we go back to mySQL - log in using your mySQL account - in our case webaccess. Follow these instructions replacing the minoTouruser with the user name of your choice:\r\n\r\n`mysql> USE Gru;`\r\n\r\n`mysql> UPDATE USERS SET admin=1 WHERE user_name = 'minoTouruser';`\r\n\r\nNow return to the website and refresh the page… Assuming all has gone to plan you will have an admin account and you should see a new ‘Admin’ menu has appeared. Currently the Admin processes are limited - you can allocate databases to different users.  The second page 'cache administration' allows you to check if the new optimised features of minoTour are working correctly.\r\n\r\nUpdate Notes: This is a new feature of minoTour that dramatically speeds up displaying data. You should follow these instructions.\r\n\r\nIf you click on 'cache administration' you will see a message that minoTour is currently not using memcached. Memcached is a unix tool that allows a website to store parameters in memory on the server. We use this to dramatically improve performance. You will need to have memcached installed on your host to use this service. We also provide background scripts that allow the server to process data.\r\n\r\nTo configure memcached in an Ubuntu environment type (you should modify as appropriate for your flavour of unix) Note you should have done this already if you followed the instructions from the start!:\r\n\r\n`sudo apt-get install memcached php5-memcache` \r\n\r\n\r\nDepending on the size of your minoTour install you can dedicate more or less memory to memCached. We recommend at least 64Mb but larger installations with more users may benefit from more memory. To configure the memory allocated to memcached see the man pages for your particular flavour of unix/memcached.\r\n\r\nAfter configuring memcached correctly you should see the message has changed on your 'cache administration' page to indicate that minoTour can see the memcache.\r\n\r\nThe perl scripts we are going to run in the background require the memcached-perl library - this can be installed on Ubuntu by typing (again - you should have done this above if all is well!):\r\n\r\n`sudo apt-get install libcache-memcached-perl`\r\n\r\nWe now need to configure these scripts to work with your installation. As with the web site there is a central configuration file located in the 'nefario' folder within the 'mT_server' folder. The example configuration file is called mT_param.example. Open this in a text editor and complete each line as follows:\r\n\t\r\ndirectory - is the path to the folder containing your minoTour website. Do not forget the trailing '/' e.g. /var/www/html/minoTour/\r\n\r\nmemcahce - is the memcache ip and port - this will work as 127.0.0.1:11211 unless you have changed your memcache install.\r\n\r\ndbhost - the database host ip\r\n\r\ndbuser - the database username you configured on page 2 of this document\r\n\r\ndbpass - the database password you configured on page 2 of this document\r\n\r\nphploc - the path to php to execute php from the command line\r\n\r\nNow you can set the background processes running by executing the command:\r\n\r\n`perl mT_control.pl`\r\n\r\nIn order to run this in the background you need to use nohup or an equivalent methodology - e.g.\r\n\r\n`nohup perl mT_control.pl &`\r\n\r\nIf you return to the website and 'cache administration' you should now see a message that your memcache is working and the backend scripts are running.\r\n\r\nGreat. Nearly there… Now to upload some data…\r\n\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}